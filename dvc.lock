schema: '2.0'
stages:
  download_data:
    cmd: kaggle datasets download -d ruchi798/bookcrossing-dataset -p data/raw/
    outs:
    - path: data/raw/bookcrossing-dataset.zip
      hash: md5
      md5: 50bce6d5bd23374f829227a31b21d884
      size: 79772605
  extract_dataset:
    cmd: unzip data/raw/bookcrossing-dataset.zip -d data/raw/
    deps:
    - path: data/raw/bookcrossing-dataset.zip
      hash: md5
      md5: 50bce6d5bd23374f829227a31b21d884
      size: 79772605
    outs:
    - path: data/raw/Book reviews/Book reviews/BX-Book-Ratings.csv
      hash: md5
      md5: 7ab62f5bddcc82f47cbed0615530805a
      size: 30682276
    - path: data/raw/Book reviews/Book reviews/BX-Users.csv
      hash: md5
      md5: cca22ab4cb53125b5d503496597123a5
      size: 12284157
    - path: data/raw/Book reviews/Book reviews/BX_Books.csv
      hash: md5
      md5: 04b9710434f92eadabc0709a5d97a8bc
      size: 77430569
    - path: data/raw/Books Data with Category Language and Summary/Preprocessed_data.csv
      hash: md5
      md5: dea9206a46573038decd0977c0433616
      size: 479942599
  download_dataset:
    cmd: kaggle datasets download -d ruchi798/bookcrossing-dataset -p data/raw/
    outs:
    - path: data/raw/bookcrossing-dataset.zip
      hash: md5
      md5: 50bce6d5bd23374f829227a31b21d884
      size: 79772605
  pack_dataset:
    cmd: poetry run python -m src.dataset "data/raw/Book reviews/Book reviews/BX-Users.csv"
      "data/raw/Book reviews/Book reviews/BX_Books.csv" "data/raw/Book reviews/Book
      reviews/BX-Book-Ratings.csv" data/interim/dataset.cloudpickle --limit=0
    deps:
    - path: data/raw/Book reviews/Book reviews/BX-Book-Ratings.csv
      hash: md5
      md5: 7ab62f5bddcc82f47cbed0615530805a
      size: 30682276
    - path: data/raw/Book reviews/Book reviews/BX-Users.csv
      hash: md5
      md5: cca22ab4cb53125b5d503496597123a5
      size: 12284157
    - path: data/raw/Book reviews/Book reviews/BX_Books.csv
      hash: md5
      md5: 04b9710434f92eadabc0709a5d97a8bc
      size: 77430569
    - path: src/dataset.py
      hash: md5
      md5: 11fc566fde50a21a4eb08e84a4f73992
      size: 5876
    outs:
    - path: data/interim/dataset.cloudpickle
      hash: md5
      md5: 5173458e8cd9fca873ca7fb5d30d07e6
      size: 93850967
  build_features:
    cmd: poetry run python -m src.features data/interim/dataset.cloudpickle data/interim/features.cloudpickle
      --chunk_size=100
    deps:
    - path: data/interim/dataset.cloudpickle
      hash: md5
      md5: 5173458e8cd9fca873ca7fb5d30d07e6
      size: 93850967
    - path: src/features.py
      hash: md5
      md5: c8ec6765d6793e7bd5121d7fbd69e1be
      size: 4330
    outs:
    - path: data/interim/features.cloudpickle
      hash: md5
      md5: f2d0911ba9d9a19a6d8476f58d29f9e3
      size: 834300286
  train:
    cmd: poetry run python -m src.modeling.train data/interim/features.cloudpickle
      models/model.pth --num_epochs=10 --batch_size=32
    deps:
    - path: data/interim/features.cloudpickle
      hash: md5
      md5: f2d0911ba9d9a19a6d8476f58d29f9e3
      size: 834300286
    - path: src/modeling/data_loader.py
      hash: md5
      md5: 6f27fb16cae0232f9524efd0a62e96d2
      size: 1530
    - path: src/modeling/model.py
      hash: md5
      md5: 713de25a5f4cd097c8b714cebe4334bf
      size: 697
    - path: src/modeling/train.py
      hash: md5
      md5: 018e1a9b45e5f6fe3776d22ce35ce94a
      size: 2460
    outs:
    - path: models/model.pth
      hash: md5
      md5: adc049d79b39d59a33c92cb30a50cf41
      size: 2368232
  predict:
    cmd: poetry run python -m src.modeling.predict data/interim/features.cloudpickle
      models/model.pth data/processed/predicted.parquet
    deps:
    - path: data/interim/features.cloudpickle
      hash: md5
      md5: f2d0911ba9d9a19a6d8476f58d29f9e3
      size: 834300286
    - path: models/model.pth
      hash: md5
      md5: adc049d79b39d59a33c92cb30a50cf41
      size: 2368232
    - path: src/modeling/data_loader.py
      hash: md5
      md5: 6f27fb16cae0232f9524efd0a62e96d2
      size: 1530
    - path: src/modeling/model.py
      hash: md5
      md5: 713de25a5f4cd097c8b714cebe4334bf
      size: 697
    - path: src/modeling/predict.py
      hash: md5
      md5: e52c90b0a88ec0be8e0a6d26678c52a2
      size: 2158
    outs:
    - path: data/processed/predicted.parquet
      hash: md5
      md5: 87fe4433207dafba9290591ca1fe8d3b
      size: 630744
